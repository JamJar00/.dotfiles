- defaults:
    link:
      relink: true

- clean: ['~']

- link:
    ~/.bashrc: bashrc
    ~/.gitconfig: gitconfig
    ~/.vimrc: vimrc
    ~/.config/nvim/init.vim:
        create: true
        path: vimrc

- conditional:
    if: test "$(uname)" = "Darwin"
    then:
      - brew:
        - bash
        - bash-completion
        - docker
        - gnupg
        - helm
        - jq
        - kubectx
        - kubernetes-cli
        - mcfly
        - minikube
        - neovim
        - tfenv
        - watch

      - cask:
        - iterm2
        - karabiner-elements
        - wacom-tablet
    else:
      - shell:
        # In WSL 1 the gzip binary doesn't extract correctly and this command fails leaving a nasty looking file in the working drectory too
        # https://askubuntu.com/questions/1417255/trying-to-unzip-a-tgz-in-wsl-but-get-elf-not-found-error
        - ["command -v mcfly &> /dev/null || curl -LSfs https://raw.githubusercontent.com/cantino/mcfly/master/ci/install.sh | sh -s -- --git cantino/mcfly --to ~/.bin", "Installing McFly"]

      - shell:
        - ["cp ./windows-terminal.json /mnt/c/Users/jamie/AppData/Local/Packages/Microsoft.WindowsTerminal_8wekyb3d8bbwe/LocalState/settings.json", "Copying in Windows Terminal settings"]

      - shell:
        - ["command -v poetry &> /dev/null || curl -sSL https://install.python-poetry.org | python3 -", "Installing Poetry"]

      - scoop:
          buckets:
            - extras
          apps:
            - 7zip
            - powertoys
            - screentogif
            - win32yank
            # TODO Windows Terminal

- shell:
  - [ "pip3 install pynvim", "Installing nvim Python library"]
  - [ "nvim --headless +PlugInstall +qall", "Installing nvim plugins"]
